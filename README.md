# ИДЗ-3. Вариант 7
Исполнитель: Миронов Павел Андреевич. Группа: БПИ-212
## Условие задачи
Есть три процесса–курильщика и один
процесс–посредник. Курильщик непрерывно скручивает сигареты и курит их. Чтобы скрутить сигарету, нужны табак, бумага и спички. У одного процесса–курильщика есть табак, у второго — бумага, а у третьего — спички. Посредник кладет на стол по два разных случайных компонента. Тот процесс–курильщик, у которого
есть третий компонент, забирает компоненты со стола, скручивает
сигарету и курит. Посредник дожидается, пока курильщик закончит, затем процесс повторяется. Создать приложение, моделирующее поведение курильщиков и посредника. Каждый
курильщик — клиент. Посредник — сервер.
## 4-5 баллов
### Сценарий

#### Сервер:
1. Сервер запускается и начинает слушать определенный порт для входящих соединений.
2. Клиент подключается к серверу - сервер принимает соединение и получает id клиента и компонент, которые клиент передает.
3. Сервер сохраняет информацию о клиенте (id и компонент) и увеличивает счетчик подключенных клиентов.
4. Если количество подключенных клиентов меньше нужного значения, сервер ожидает подключения следующего клиента.
5. Когда количество подключенных клиентов достигает нужного значения, сервер генерирует два случайных компонента из трех возможных.
6. Сервер отправляет сгенерированные компоненты всем подключенным клиентам.
7. Сервер ожидает сообщения от клиентов о том, что они курят сигарету. Когда сервер получает такое сообщение, он начинает новый раунд.
8. Сервер повторяет всё с шага 5

#### Клиент:
1. Клиент запускается и устанавливает соединение с сервером, используя заданный IP-адрес и порт.
2. Клиент передает серверу свой id и компонент (от 1 до 3: табак, бумага, спички).
3. Клиент ожидает сообщения от сервера с двумя сгенерированными компонентами.
4. Клиент проверяет, имеет ли он третий компонент, необходимый для скручивания сигареты. Если да, то клиент отправляет серверу сообщение о том, что он забирает компоненты со стола и курит сигарету.
5. Клиент отображает сообщения о том, что он забирает компоненты со стола и курит сигарету.
6. Клиент ожидает следующего раунда, когда сервер снова отправит два сгенерированных компонента.

В процессе обмена сервер и клиенты выводят сообщения о получении и отправке данных, чтобы отразить текущее состояние и взаимодействие.

Приложение может работать как на одном компьютере, так и на нескольких компьютерах при условии правильного указания ip-адресов, их доступности в сети и открытых портах.

### Пример результата работы
Сервер
```
Сервер: Запущен на порте 5000
Сервер: Принято входящее подключение 127.0.0.1:47606
Сервер: Получено сообщение от клиента: 1 1
Сервер: Получены данные от клиента: id=1, component=табак
Сервер: Клиент 1 добавлен
Сервер: Принято входящее подключение 127.0.0.1:47620
Сервер: Получено сообщение от клиента: 2 2
Сервер: Получены данные от клиента: id=2, component=бумага
Сервер: Клиент 2 добавлен
Сервер: Принято входящее подключение 127.0.0.1:47624
Сервер: Получено сообщение от клиента: 3 3
Сервер: Получены данные от клиента: id=3, component=спички
Сервер: Клиент 3 добавлен
Сервер: Все клиенты подключены
Сервер: Сгенерированы компоненты: бумага и спички
Сервер: Отправлены компоненты клиентам
Сервер: Получено сообщение от клиента 1: smoking
Сервер: Клиент 1 получил компоненты и начал курить
Сервер: Клиент 1 закончил курить
Сервер: Сгенерированы компоненты: табак и спички
...
```
Клиент 1
```
Клиент 1: Имеет компонент табак
Клиент 1: Подключен к серверу 127.0.0.1:5000
Клиент 1: Отправлены идентификатор и компонент на сервер
Клиент 1: Получено сообщение от сервера: 2 3
Клиент 1: Получены два компонента от сервера: бумага и спички
У клиента 1 есть третий компонент
Клиент 1: Отправлено сообщение на сервер: smoking
Клиент 1: Берет предметы со стола и курит сигарету
Клиент 1: Закончил курить сигарету
Клиент 1: Получено сообщение от сервера: 1 3
Клиент 1: Получены два компонента от сервера: табак и спички
Клиент 1: Не имеет третьего компонента
...
```
Клиент 2
```
Клиент 2: Имеет компонент бумага
Клиент 2: Подключен к серверу 127.0.0.1:5000
Клиент 2: Отправлены идентификатор и компонент на сервер
Клиент 2: Получено сообщение от сервера: 2 3
Клиент 2: Получены два компонента от сервера: бумага и спички
Клиент 2: Не имеет третьего компонента
Клиент 2: Получено сообщение от сервера: 1 3
Клиент 2: Получены два компонента от сервера: табак и спички
У клиента 2 есть третий компонент
Клиент 2: Отправлено сообщение на сервер: smoking
Клиент 2: Берет предметы со стола и курит сигарету
Клиент 2: Закончил курить сигарету
...
```
Клиент 3
```
Клиент 3: Имеет компонент спички
Клиент 3: Подключен к серверу 127.0.0.1:5000
Клиент 3: Отправлены идентификатор и компонент на сервер
Клиент 3: Получено сообщение от сервера: 2 3
Клиент 3: Получены два компонента от сервера: бумага и спички
Клиент 3: Не имеет третьего компонента
Клиент 3: Получено сообщение от сервера: 1 3
Клиент 3: Получены два компонента от сервера: табак и спички
Клиент 3: Не имеет третьего компонента
...
```

#### P.S.
Для удобства тестирования написан docker-compose файл, который запускает контейнер с рабочим gcc
```
docker-compose up -d
```

Для подключения к контейнеру используйте команду
```
docker compose exec -it server bash
```